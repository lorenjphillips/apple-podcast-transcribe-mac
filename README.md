# Apple Podcast Transcriber

A comprehensive toolkit for extracting episode URLs from Apple Podcasts and transcribing them using Whisper.

## Features

- **üéØ Apple Podcast URL Scraping**: Extract all episode URLs from any Apple Podcast
- **üîç Smart Episode Discovery**: Find older episodes using multiple search strategies
- **üéôÔ∏è Audio Transcription**: Convert podcast episodes to text using Whisper
- **üì¶ Batch Processing**: Handle hundreds of episodes efficiently
- **üîÑ Progress Tracking**: Real-time progress indicators
- **üíæ Flexible Output**: Save transcripts individually or as combined files

## Setup

1. **Create and activate virtual environment:**
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

2. **Install dependencies:**
   ```bash
   pip install yt-dlp typer pyperclip rich requests
   ```

3. **For full transcription support:**
   ```bash
   pip install openai-whisper
   ```

## üì° Apple Podcast URL Scraping

Use the `apple_podcast_scraper.py` to extract episode URLs from any Apple Podcast:

### Basic Usage

```bash
# Extract all available episodes from a podcast
python apple_podcast_scraper.py scrape "https://podcasts.apple.com/us/podcast/founders/id1141877104"

# Save to a custom file
python apple_podcast_scraper.py scrape "https://podcasts.apple.com/podcast/id123456" --output my_podcast_urls.txt

# Search for specific episode ranges (great for finding older episodes)
python apple_podcast_scraper.py scrape "https://podcasts.apple.com/podcast/id123456" --range "1-100"
```

### Advanced Options

```bash
# Append to existing file without validation
python apple_podcast_scraper.py scrape "https://podcasts.apple.com/podcast/id123456" --append --no-validate

# Limit search requests to avoid rate limiting
python apple_podcast_scraper.py scrape "https://podcasts.apple.com/podcast/id123456" --max-requests 50

# Skip searching for older episodes (recent episodes only)
python apple_podcast_scraper.py scrape "https://podcasts.apple.com/podcast/id123456" --no-search-older
```

### Utility Commands

```bash
# Get podcast information
python apple_podcast_scraper.py info "https://podcasts.apple.com/podcast/id123456"

# Validate URLs in a file
python apple_podcast_scraper.py validate-file urls.txt --sample 20
```

### How It Works

The scraper uses multiple strategies to find episodes:

1. **iTunes API** (Primary): Fetches the most recent ~200 episodes
2. **Search API** (Secondary): Searches for older episodes by episode number
3. **Rate Limiting**: Automatically handles API limits to avoid 403 errors
4. **Deduplication**: Removes duplicate URLs while preserving order

### Example Output

```
Found 270 unique episodes
Validation: 10/10 URLs are accessible (100.0%)
Saved to podcast_urls.txt: 270 URLs

Preview of first 5 URLs:
  1. https://podcasts.apple.com/us/podcast/391-jimmy-iovine/id1141877104?i=1000712666304
  2. https://podcasts.apple.com/us/podcast/390-rare-steve-jobs-interview/id1141877104?i=1000711166034
  3. https://podcasts.apple.com/us/podcast/389-founder-jimmy-choo/id1141877104?i=1000709842024
  ... and 267 more
```

## üéôÔ∏è Audio Transcription

Once you have URLs, use the transcription system:

### Process multiple URLs from a file:
```bash
python process_urls.py process-urls urls.txt
```

### Process a single URL:
```bash
python process_urls.py single-url "https://podcasts.apple.com/us/podcast/episode/id123456?i=789"
```

### Transcription Options:
- `--model, -m`: Specify Whisper model (tiny, base, small, medium, large)
- `--clipboard/--no-clipboard`: Copy to clipboard (default: enabled)

### Examples:
```bash
# Process all episodes with custom model
python process_urls.py process-urls urls.txt --model medium

# Process without copying to clipboard (recommended for large batches)
python process_urls.py process-urls urls.txt --no-clipboard

# Process with custom model and no clipboard
python process_urls.py process-urls urls.txt --model medium --no-clipboard
```

## üìÅ File Formats

### URL File Format

The scraper creates files with this format:
```
# Podcast URLs extracted from https://podcasts.apple.com/podcast/id123456
# Total episodes: 270
# Generated by Apple Podcast Scraper

https://podcasts.apple.com/us/podcast/episode-title/id123456?i=789
https://podcasts.apple.com/us/podcast/another-episode/id123456?i=790
```

### Transcript Output

Transcripts are saved to `transcripts/` directory:
```
Episode: #391 Jimmy Iovine
URL: https://podcasts.apple.com/us/podcast/391-jimmy-iovine/id1141877104?i=1000712666304
Transcribed: /path/to/project

--------------------------------------------------------------------------------

[Transcript content here...]
```

## üõ†Ô∏è Complete Workflow

Here's a complete example of scraping and transcribing a podcast:

```bash
# 1. Extract all episode URLs
python apple_podcast_scraper.py scrape "https://podcasts.apple.com/us/podcast/founders/id1141877104" --output founders_urls.txt

# 2. Review the URLs (optional)
head -20 founders_urls.txt

# 3. Transcribe all episodes
python process_urls.py process-urls founders_urls.txt --model base

# 4. Check results
ls transcripts/
```

## üìä Performance Tips

- **Rate Limiting**: The scraper automatically handles API rate limits
- **Batch Size**: For large podcasts (300+ episodes), expect some rate limiting
- **Search Range**: Use `--range` to target specific episode ranges
- **Validation**: Use `--no-validate` to skip URL validation for faster processing

## üîß Troubleshooting

### Common Issues

1. **403 Rate Limit Errors**: Normal for large podcasts. The scraper will get what it can.
2. **Missing Episodes**: Some older episodes may not be discoverable via search.
3. **URL Format**: Make sure you're using the full Apple Podcasts URL with `/id123456`.

### Tips for Maximum Episode Discovery

1. Start with the main scraper to get recent episodes
2. Use `--range` to search specific older episode ranges
3. Try multiple smaller ranges instead of one large range
4. Wait between runs to avoid rate limiting

## üìÇ Files

- `apple_podcast_scraper.py`: Main URL extraction script
- `process_urls.py`: Audio transcription script  
- `urls.txt`: Example URL file (270 Founders podcast episodes)
- `transcripts/`: Directory where transcripts are saved
- `venv/`: Python virtual environment

## ü§ù Contributing

The scraper works with any Apple Podcast! Try it with your favorite shows and let us know how it performs.

## üìù Notes

- The transcription uses OpenAI's Whisper for high-quality results
- Audio files are temporarily downloaded and automatically cleaned up
- All Apple Podcast URLs are supported - just change the podcast ID
- The scraper respects Apple's API rate limits